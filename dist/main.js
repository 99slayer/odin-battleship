(()=>{"use strict";const e=(e,t)=>{for(let n=0;n<11;n+=1){let l=n,r=document.createElement("div");r.classList.add("grid-row"),r.setAttribute("id",`grid-row-${n}`),r.setAttribute("data-row-number",`${n}`);for(let e=0;e<11;e+=1){let n=document.createElement("div");n.classList.add("grid-cell"),n.classList.add(`grid-cell-${t}`),n.setAttribute("id",`grid-cell-${e}-${l}`),n.setAttribute("data-cell-coordinate",`${e}-${l}`),n.style.border="1px solid black",r.appendChild(n)}e.appendChild(r)}(()=>{const t=[];e.childNodes.forEach((e=>{t.push(e.firstChild)}));let n=1;t.forEach((e=>{e.style.border="none","0-0"!==e.getAttribute("data-cell-coordinate")&&(e.textContent=`${n}`,n+=1)}))})(),(()=>{const t=e.firstChild.childNodes;let n=0;t.forEach((e=>{e.style.border="none","0-0"!==e.getAttribute("data-cell-coordinate")&&(e.textContent=`${String.fromCharCode(65+n)}`,n+=1)}))})()},t=e=>{if("string"!=typeof e)return;let t=e.split("");return(e=>{let t;t=isNaN(parseInt(e[1]))?e[0]:e.slice(0,2).join("");let n=parseInt(t);return String.fromCharCode(65+n-1)})(t)+(e=>{let t;return t=isNaN(parseInt(e[e.length-2]))?e[e.length-1]:e.slice(e.length-2).join(""),t})(t)},n=(e,t=!1)=>{const n=e,l=(()=>{const e=[],t=[];return{attacks:t,place:t=>{let n=(e=>{let t=e,n=t.length,l=0;return{coordinates:t,hit:()=>{l+=1},isSunk:()=>n===l,getDamage:()=>l}})(t);return e.push(n),n},receiveAttack:n=>{if(t.includes(n))return;let l=e.findIndex((e=>e.coordinates.includes(n)));l>-1&&e[l].hit(),t.push(n)},fleetCoordinates:()=>{const t=[];for(let n=0;n<e.length;n+=1)t.push(e[n].coordinates);return t},getShipsRemaining:()=>{let t=0;return e.forEach((e=>{e.isSunk()&&(t+=1)})),e.length-t},isFleetSunk:()=>!!e.every((e=>e.isSunk()))}})(),r=t;return{board:l,computer:r,isTurn:!1,makeAttack:(e,t=null)=>{let n=t;r&&(n=((e,t=1)=>{const n=()=>Math.floor(10*Math.random())+65;let l=String.fromCharCode(n()),r=Math.floor(10*Math.random()+1),o=l+r;if(e.attacks.includes(o))do{l=String.fromCharCode(n()),r=Math.floor(10*Math.random()+1),o=l+r}while(e.attacks.includes(o));return o})(e)),e.attacks.includes(n)?console.log("square has already been hit."):(e.receiveAttack(n),console.log(`computer has attacked ${n}.`))},getName:()=>n,getWins:()=>0}},l=(e,t)=>{const n=document.getElementById("player-one-display"),l=document.getElementById("player-two-display");e.isTurn?(n.classList.add("current-player"),l.classList.remove("current-player")):t.isTurn&&(l.classList.add("current-player"),n.classList.remove("current-player"))},r=(e,t)=>{e.isTurn?(e.isTurn=!1,t.isTurn=!0,console.log(`IT IS NOW ${t.getName()}s TURN.`)):t.isTurn&&(e.isTurn=!0,t.isTurn=!1,console.log(`IT IS NOW ${e.getName()}s TURN.`))};let o,a;const c=(e,n)=>{const l=n.board.fleetCoordinates().reduce(((e,t)=>e.concat(t)));e.forEach((e=>{let r=t(e.getAttribute("data-cell-coordinate"));l.includes(r)&&n.board.attacks.includes(r)?e.textContent="●":!l.includes(r)&&n.board.attacks.includes(r)?e.textContent="/":l.includes(r)&&(e.textContent="○")}))},d=document.getElementById("player-one-display"),s=document.getElementById("player-two-display"),i=(e,t)=>{const n=document.createElement("div");n.classList.add("display-cont");const l=document.createElement("h1");l.textContent=`PLAYER ${t}`;const r=document.createElement("h3");r.textContent=`${e.getName()}`;const o=document.createElement("p");o.textContent=`${e.isTurn}`;const a=document.createElement("p");a.textContent=`Ships left: ${e.board.getShipsRemaining()}`;const c=document.createElement("p");c.textContent=`Wins: ${e.getWins()}`,n.append(l,r,o,a,c),1===t?d.append(n):2===t&&s.append(n)},u=document.getElementById("menu-multiplayer"),m=document.getElementById("menu-names"),g=(document.getElementById("menu-rules"),document.getElementById("single-player")),p=document.getElementById("two-player"),h=document.getElementById("player-one-name"),y=document.getElementById("start"),E=e=>{e.style.display="none"},A=e=>{e.style.display=null},b=(g.addEventListener("click",(()=>{E(u),A(m),multiplayer=!1})),p.addEventListener("click",(()=>{E(u),A(m),multiplayer=!0})),y.addEventListener("click",(()=>{let e=[h.value,"computer"],t=e[0],l=e[1];""!==t&&""!==l&&(((e,t)=>{let l=!0;"computer"===t&&(l=!1),o=n(e),a=n(t,l),o.board.place(["A2","A3","A4"]),o.board.place(["E3","F3","G3"]),o.board.place(["A1","B1","C1","D1"]),o.board.place(["C10","D10","E10","F10"]),a.board.place(["A4","B4","C4"]),a.board.place(["A5","A6","A7"]),a.board.place(["E5","F5","G5","H5"]),a.board.place(["E6","E7","E8","E9"]),c(document.querySelectorAll(".grid-cell-1"),o),c(document.querySelectorAll(".grid-cell-2"),a),((e,t)=>{let n=Math.floor(10*Math.random()+1);n%2==0?(e.isTurn=!0,console.log(`${e.getName()} GOES FIRST.`)):n%2!=0&&(t.isTurn=!0,console.log(`${t.getName()} GOES FIRST.`))})(o,a),o.isTurn&&o.computer?(o.makeAttack(a.board),changeTurn(o,a),highlight(o,a),c(document.querySelectorAll(".grid-cell-1"),o),c(document.querySelectorAll(".grid-cell-2"),a)):a.isTurn&&a.computer&&(a.makeAttack(o.board),changeTurn(o,a),highlight(o,a),c(document.querySelectorAll(".grid-cell-1"),o),c(document.querySelectorAll(".grid-cell-2"),a))})(t,l),i(o,1),i(a,2),h.value="",E(m))})),document.getElementById("player-one-grid")),k=document.getElementById("player-two-grid");e(b,1),e(k,2),document.querySelectorAll(".grid-cell").forEach((e=>{e.addEventListener("click",(e=>{let n=(d=e.target,t(d.getAttribute("data-cell-coordinate")));var d;console.log(`coordinate: ${n}`),(async(e,t,n)=>{e.isTurn?(e.makeAttack(t.board,n),r(e,t),l(e,t)):t.isTurn&&(t.makeAttack(e.board,n),r(e,t),l(e,t)),e.computer?(e.makeAttack(t.board),r(e,t),l(e,t)):t.computer&&(r(e,t),l(e,t)),c(document.querySelectorAll(".grid-cell-1"),e),c(document.querySelectorAll(".grid-cell-2"),t)})(o,a,n)}))})),console.log("check check")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMxQyxFQUFXMEIsRUFBWUMsR0FDdkIsRUFBVUQsRUFBWUMsSUFHckJELEVBQVlmLFVBQ2JlLEVBQVliLFdBQVdjLEVBQWF4QyxPQUNwQyxFQUFXdUMsRUFBWUMsR0FDdkIsRUFBVUQsRUFBWUMsSUFDYkEsRUFBYWhCLFdBQ3RCLEVBQVdlLEVBQVlDLEdBQ3ZCLEVBQVVELEVBQVlDLElBRXhCTyxFQUFXdkYsU0FBU3dILGlCQUFpQixnQkFBZ0J6QyxHQUNyRFEsRUFBV3ZGLFNBQVN3SCxpQkFBaUIsZ0JBQWdCeEMsRUFBYSxFRTNCOURvQixDQUFLZixFQUFVQyxFQUFVUyxFQUFNLEdBQy9CLElJckJOcEIsUUFBUUMsSUFBSSxjIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwLy4vc3JjL0RPTS9jb21wb25lbnRzL2NyZWF0ZUdyaWQuanMiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvcGFyc2VDZWxsQ29vcmRpbmF0ZS5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvZmFjdG9yaWVzL2NyZWF0ZVBsYXllci5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvZmFjdG9yaWVzL2NyZWF0ZUdhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvZmFjdG9yaWVzL2NyZWF0ZVNoaXAuanMiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwLy4vc3JjL0RPTS9pbnRlcmFjdGlvbi9wbGF5ZXJEaXNwbGF5cy5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy90dXJuLmpzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL2dhbWVTdGFydC5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvRE9NL2ludGVyYWN0aW9uL2dyaWQuanMiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwLy4vc3JjL0RPTS9jb21wb25lbnRzL2NyZWF0ZVBsYXllckRpc3BsYXlzLmpzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcC8uL3NyYy9ET00vaW50ZXJhY3Rpb24vbWVudS5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9nYW1lTG9vcC5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGNyZWF0ZUdyaWQgPSAoZ3JpZCxncmlkTnVtKSA9PiB7XG4gIGZvcihsZXQgaT0wO2k8MTE7aSs9MSl7XG4gICAgbGV0IHJvdyA9IGk7XG4gICAgbGV0IGdyaWRSb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBncmlkUm93LmNsYXNzTGlzdC5hZGQoJ2dyaWQtcm93Jyk7XG4gICAgZ3JpZFJvdy5zZXRBdHRyaWJ1dGUoJ2lkJyxgZ3JpZC1yb3ctJHtpfWApO1xuICAgIGdyaWRSb3cuc2V0QXR0cmlidXRlKCdkYXRhLXJvdy1udW1iZXInLGAke2l9YCk7XG4gICAgLy9QUk9CQUJMWSBET05UIE5FRUQgSUQgQU5EIERBVEEgQVRUUklCVVRFLCBCVVQgSSdMTCBDT01FIEJBQ0sgVE8gVEhJUy5cbiAgICBmb3IobGV0IGk9MDtpPDExO2krPTEpe1xuICAgICAgbGV0IGN1cnJlbnRSb3cgPSByb3dcbiAgICAgIGxldCBncmlkQ2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgZ3JpZENlbGwuY2xhc3NMaXN0LmFkZCgnZ3JpZC1jZWxsJyk7XG4gICAgICBncmlkQ2VsbC5jbGFzc0xpc3QuYWRkKGBncmlkLWNlbGwtJHtncmlkTnVtfWApO1xuICAgICAgZ3JpZENlbGwuc2V0QXR0cmlidXRlKCdpZCcsYGdyaWQtY2VsbC0ke2l9LSR7cm93fWApO1xuICAgICAgZ3JpZENlbGwuc2V0QXR0cmlidXRlKCdkYXRhLWNlbGwtY29vcmRpbmF0ZScsYCR7aX0tJHtyb3d9YCk7XG4gICAgICBncmlkQ2VsbC5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkIGJsYWNrJztcbiAgICAgIGdyaWRSb3cuYXBwZW5kQ2hpbGQoZ3JpZENlbGwpO1xuICAgIH07XG4gICAgZ3JpZC5hcHBlbmRDaGlsZChncmlkUm93KTtcbiAgfTtcblxuICBjb25zdCBsYWJlbFJvd3MgPSAoKSA9PiB7XG4gICAgY29uc3Qgbm9kZUxpc3QgPSBbXTtcbiAgICBsZXQgcm93cyA9IGdyaWQuY2hpbGROb2RlcztcblxuICAgIHJvd3MuZm9yRWFjaCgoZSk9PntcbiAgICAgIG5vZGVMaXN0LnB1c2goZS5maXJzdENoaWxkKTtcbiAgICB9KTtcblxuICAgIGxldCBpID0gMTtcbiAgICBub2RlTGlzdC5mb3JFYWNoKChlKT0+e1xuICAgICAgZS5zdHlsZS5ib3JkZXIgPSAnbm9uZSc7XG4gICAgICBpZihlLmdldEF0dHJpYnV0ZSgnZGF0YS1jZWxsLWNvb3JkaW5hdGUnKSA9PT0gJzAtMCcpe1xuICAgICAgICByZXR1cm47XG4gICAgICB9O1xuICAgICAgZS50ZXh0Q29udGVudCA9IGAke2l9YDtcbiAgICAgIGkgKz0gMTtcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBsYWJlbENvbHVtbnMgPSAoKSA9PiB7XG4gICAgY29uc3Qgbm9kZUxpc3QgPSBncmlkLmZpcnN0Q2hpbGQuY2hpbGROb2RlcztcbiAgICBsZXQgaSA9IDBcbiAgICBub2RlTGlzdC5mb3JFYWNoKChlKT0+e1xuICAgICAgZS5zdHlsZS5ib3JkZXIgPSAnbm9uZSc7XG4gICAgICBjb25zdCBjZWxsQ29vcmRpbmF0ZSA9IGUuZ2V0QXR0cmlidXRlKCdkYXRhLWNlbGwtY29vcmRpbmF0ZScpO1xuICAgICAgaWYoY2VsbENvb3JkaW5hdGUgPT09ICcwLTAnKXtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfTtcbiAgICAgIGUudGV4dENvbnRlbnQgPSBgJHtTdHJpbmcuZnJvbUNoYXJDb2RlKDY1ICsgaSl9YDtcbiAgICAgIGkgKz0gMTtcbiAgICB9KTtcbiAgfTtcblxuICBsYWJlbFJvd3MoKTtcbiAgbGFiZWxDb2x1bW5zKCk7XG59O1xuIiwiLy9pbnB1dCBjZWxsIGVsZW1lbnQgZGF0YSBhdHRyaWJ1dGVcbi8vb3V0cHV0IGF0dGFjayBjb29yZGluYXRlc1xuZXhwb3J0IGNvbnN0IHBhcnNlQ2VsbENvb3JkaW5hdGUgPSAoYXR0cmlidXRlKSA9PiB7XG4gIGlmKHR5cGVvZiBhdHRyaWJ1dGUgIT09ICdzdHJpbmcnKXtcbiAgICByZXR1cm47XG4gIH07XG5cbiAgbGV0IGFyciA9IGF0dHJpYnV0ZS5zcGxpdCgnJyk7XG5cbiAgY29uc3QgZ2V0TGV0dGVyID0gKGFycmF5KSA9PiB7XG4gICAgbGV0IGxldHRlclZhbHVlO1xuXG4gICAgaWYoIShpc05hTihwYXJzZUludChhcnJheVsxXSkpKSl7XG4gICAgICBsZXQgdHdvRGlnaXQgPSBhcnJheS5zbGljZSgwLDIpO1xuICAgICAgbGV0dGVyVmFsdWUgPSB0d29EaWdpdC5qb2luKCcnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGV0dGVyVmFsdWUgPSBhcnJheVswXTtcbiAgICB9O1xuXG4gICAgbGV0IGNvZGVWYWx1ZSA9IHBhcnNlSW50KGxldHRlclZhbHVlKTtcbiAgICBsZXQgbGV0dGVyID0gU3RyaW5nLmZyb21DaGFyQ29kZSgoNjUgKyBjb2RlVmFsdWUpIC0gMSk7XG4gICAgLy8gY29uc29sZS5sb2cobGV0dGVyKTtcbiAgICByZXR1cm4gbGV0dGVyO1xuICB9O1xuXG4gIGNvbnN0IGdldE51bWJlciA9IChhcnJheSkgPT4ge1xuICAgIGxldCBudW1iZXI7XG4gICAgaWYoIShpc05hTihwYXJzZUludChhcnJheVthcnJheS5sZW5ndGgtMl0pKSkpe1xuICAgICAgbGV0IHR3b0RpZ2l0ID0gYXJyYXkuc2xpY2UoYXJyYXkubGVuZ3RoLTIpO1xuICAgICAgbnVtYmVyID0gdHdvRGlnaXQuam9pbignJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG51bWJlciA9IGFycmF5W2FycmF5Lmxlbmd0aC0xXTtcbiAgICB9O1xuICAgIC8vIGNvbnNvbGUubG9nKG51bWJlcik7XG4gICAgcmV0dXJuIG51bWJlcjtcbiAgfTtcblxuICBsZXQgbGV0dGVyID0gZ2V0TGV0dGVyKGFycik7XG4gIGxldCBudW1iZXIgPSBnZXROdW1iZXIoYXJyKTtcbiAgLy8gY29uc29sZS5sb2cobGV0dGVyICsgbnVtYmVyKTtcbiAgcmV0dXJuIGxldHRlciArIG51bWJlcjtcbn07XG4iLCJpbXBvcnQgeyBjcmVhdGVHYW1lYm9hcmQgfSBmcm9tIFwiLi9jcmVhdGVHYW1lYm9hcmRcIjtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVBsYXllciA9IChwbGF5ZXJOYW1lLGlzQ29tcCA9IGZhbHNlKSA9PntcbiAgY29uc3QgbmFtZSA9IHBsYXllck5hbWU7XG4gIGNvbnN0IGJvYXJkID0gY3JlYXRlR2FtZWJvYXJkKCk7XG4gIGNvbnN0IGNvbXB1dGVyID0gaXNDb21wO1xuICBsZXQgaXNUdXJuID0gZmFsc2U7XG4gIGxldCB3aW5zID0gMDtcbiAgXG4gIGNvbnN0IG1ha2VBdHRhY2sgPSAoZW5lbXlCb2FyZCxjb29yZGluYXRlcyA9IG51bGwpID0+IHtcbiAgICBsZXQgdGFyZ2V0ID0gY29vcmRpbmF0ZXM7XG5cbiAgICBpZihjb21wdXRlcil7XG4gICAgICAvL3VzZSBzZXQgaW50ZXJ2YWwgdG8gaGF2ZSBhIHNtYWxsIGRlbGF5IGhlcmVcbiAgICAgIHRhcmdldCA9IGdlbmVyYXRlQXR0YWNrKGVuZW15Qm9hcmQpO1xuICAgIH07XG5cbiAgICBpZihlbmVteUJvYXJkLmF0dGFja3MuaW5jbHVkZXModGFyZ2V0KSl7XG4gICAgICBjb25zb2xlLmxvZygnc3F1YXJlIGhhcyBhbHJlYWR5IGJlZW4gaGl0LicpO1xuICAgICAgcmV0dXJuO1xuICAgIH07XG4gICAgZW5lbXlCb2FyZC5yZWNlaXZlQXR0YWNrKHRhcmdldCk7XG4gICAgY29uc29sZS5sb2coYGNvbXB1dGVyIGhhcyBhdHRhY2tlZCAke3RhcmdldH0uYCk7XG4gIH07XG5cbiAgY29uc3QgcGxhY2VGbGVldCA9ICgpID0+IHtcblxuICB9O1xuICBcbiAgY29uc3QgZ2VuZXJhdGVBdHRhY2sgPSAoZW5lbXlCb2FyZCxnZW4gPSAxKSA9PiB7XG4gICAgLy9jb3VsZCBwb3RlbnRpYWxseSBtYWtlIGl0ICdzbWFydGVyJyBsYXRlciBvbiBha2EsIG9uY2UgaXQgbGFuZHMgYSBoaXQsIGZvY3VzIG9uIHRoYXQgYXJlYSB1bnRpbCB0aGUgc2hpcCBpcyBzdW5rLlxuICAgIGNvbnN0IGdlbmVyYXRlQ2hhckNvZGUgPSAoKSA9PiB7XG4gICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKDc0IC0gNjUgKyAxKSApICsgNjU7XG4gICAgfTtcblxuICAgIGxldCBsZXR0ZXIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGdlbmVyYXRlQ2hhckNvZGUoKSk7XG4gICAgbGV0IG51bWJlciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwICsgMSk7XG4gICAgbGV0IHRhcmdldCA9IGxldHRlciArIG51bWJlcjtcblxuICAgIC8vY2hlY2tzIGlmIHNxdWFyZXMgaGF2ZSBhbHJlYWR5IGJlZW4gaGl0XG4gICAgaWYoZW5lbXlCb2FyZC5hdHRhY2tzLmluY2x1ZGVzKHRhcmdldCkpe1xuICAgICAgZG97XG4gICAgICAgIGxldHRlciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZ2VuZXJhdGVDaGFyQ29kZSgpKTtcbiAgICAgICAgbnVtYmVyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAgKyAxKTtcbiAgICAgICAgdGFyZ2V0ID0gbGV0dGVyICsgbnVtYmVyO1xuICAgICAgfVxuICAgICAgd2hpbGUgKGVuZW15Qm9hcmQuYXR0YWNrcy5pbmNsdWRlcyh0YXJnZXQpKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfTtcblxuICBjb25zdCBnZXROYW1lID0gKCkgPT4ge1xuICAgIHJldHVybiBuYW1lO1xuICB9O1xuXG4gIGNvbnN0IGdldFdpbnMgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHdpbnM7XG4gIH07XG5cbiAgcmV0dXJuIHsgYm9hcmQsIGNvbXB1dGVyLCBpc1R1cm4sIG1ha2VBdHRhY2ssIGdldE5hbWUsIGdldFdpbnMgfTtcbn07XG4iLCJpbXBvcnQgeyBjcmVhdGVTaGlwIH0gZnJvbSBcIi4vY3JlYXRlU2hpcFwiO1xuXG5leHBvcnQgY29uc3QgY3JlYXRlR2FtZWJvYXJkID0gKCkgPT57XG4gIGNvbnN0IHNoaXBzID0gW107XG4gIGNvbnN0IGF0dGFja3MgPSBbXTtcblxuICBmdW5jdGlvbiBPTERwbGFjZShheGlzLHN0YXJ0LHNpemUpe1xuICAgIC8vWCA9PiBob3Jpem9udGFsICsgbGV0dGVyc1xuICAgIC8vWSA9PiB2ZXJ0aWNhbCArIG51bWJlcnNcbiAgICBpZighYXhpc3x8IXN0YXJ0fHwhc2l6ZSl7XG4gICAgICBjb25zb2xlLmxvZygncGFyYW1ldGVyIG1pc3NpbmcnKTtcbiAgICAgIHJldHVybjtcbiAgICB9O1xuXG4gICAgbGV0IHN0YXJ0QXJyID0gc3RhcnQuc3BsaXQoJycpO1xuICAgIGxldCB4ID0gc3RhcnRBcnIuc2xpY2UoMCwxKTtcbiAgICBsZXQgeSA9IHN0YXJ0QXJyLnNsaWNlKDEpLmpvaW4oJycpO1xuXG4gICAgLy90aHJvd3MgZXJyb3IgaWYgc2hpcHMgd291bGQgYmUgcGxhY2VkIG91dCBvZiBib3VuZHNcbiAgICAvL3Rocm93cyBlcnJvcnMgZm9yIG5vdyBtYXliZSBjaGFuZ2UgbGF0ZXIqKlxuICAgIC8vVEhFIENPT1JESU5BVEVTIENBTiBCRSBDSEVDS0VEIEJFRk9SRSBUSEVZIEFSRSBQQVNTRUQgVE8gUExBQ0UqKlxuICAgIGlmKCh4WzBdLmNoYXJDb2RlQXQoMCkrc2l6ZSk+NzQpe1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdzaGlwIGV4Y2VlZHMgdGhlIHggYXhpcyBvZiB0aGUgZ2FtZWJvYXJkLicpO1xuICAgIH0gZWxzZSBpZiAoKHBhcnNlSW50KHkpK3NpemUpPjEwKXtcbiAgICAgIHRocm93IG5ldyBFcnJvcignc2hpcCBleGNlZWRzIHRoZSB5IGF4aXMgb2YgdGhlIGdhbWVib2FyZC4nKTtcbiAgICB9O1xuXG4gICAgLy9DaGVjayBpZiBwbGFjZW1lbnQgY29vcmRpbmF0ZXMgY29uZmxpY3Qgd2l0aCBhbnkgb3RoZXIgc2hpcHNcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNvb3JkaW5hdGVzKHNoaXBBeGlzLHNoaXBTaXplKXtcbiAgICAgIGxldCBjb29yZGluYXRlcyA9IFtdO1xuXG4gICAgICBpZihzaGlwQXhpcyA9PT0gJ1gnKXtcbiAgICAgICAgLy9pbmNyZW1lbnQgbGV0dGVyc1xuICAgICAgICBmb3IobGV0IGk9MDtpPHNoaXBTaXplO2krPTEpe1xuICAgICAgICAgIGxldCBuZXdYID0gU3RyaW5nLmZyb21DaGFyQ29kZSh4WzBdLmNoYXJDb2RlQXQoMCkraSk7XG4gICAgICAgICAgY29vcmRpbmF0ZXMucHVzaChgJHtuZXdYICsgeX1gKTtcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSBpZiAoc2hpcEF4aXMgPT09ICdZJyl7XG4gICAgICAgIC8vaW5jcmVtZW50IG51bWJlcnNcbiAgICAgICAgZm9yKGxldCBpPTA7aTxzaGlwU2l6ZTtpKz0xKXtcbiAgICAgICAgICBjb29yZGluYXRlcy5wdXNoKGAke3ggKyAocGFyc2VJbnQoeSkgKyBpKX1gKTtcbiAgICAgICAgfTtcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiBjb29yZGluYXRlcztcbiAgICB9O1xuXG5cbiAgICBsZXQgc2hpcCA9IGNyZWF0ZVNoaXAoY3JlYXRlQ29vcmRpbmF0ZXMoYXhpcyxzaXplKSk7XG4gICAgc2hpcHMucHVzaChzaGlwKTtcbiAgfTsgLy9PTEQgUExBQ0UgRlVOQ1RJT04sIFNUSUxMIFVTRUZVTCBDT0RFIElOIEhFUkUgRk9SIExBVEVSKipcblxuICBjb25zdCBwbGFjZSA9IChjb29yZGluYXRlcykgPT4ge1xuICAgIGxldCBuZXdTaGlwID0gY3JlYXRlU2hpcChjb29yZGluYXRlcyk7XG4gICAgc2hpcHMucHVzaChuZXdTaGlwKTtcbiAgICByZXR1cm4gbmV3U2hpcDtcbiAgfVxuXG4gIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAodGFyZ2V0KSA9PiB7XG4gICAgaWYoYXR0YWNrcy5pbmNsdWRlcyh0YXJnZXQpKXtcbiAgICAgIHJldHVybjtcbiAgICB9O1xuXG4gICAgbGV0IHNoaXBJbmRleCA9IHNoaXBzLmZpbmRJbmRleCgoc2hpcCk9PnsgcmV0dXJuIHNoaXAuY29vcmRpbmF0ZXMuaW5jbHVkZXModGFyZ2V0KX0pO1xuXG4gICAgaWYoc2hpcEluZGV4Pi0xKXtcbiAgICAgIHNoaXBzW3NoaXBJbmRleF0uaGl0KCk7XG4gICAgfTtcblxuICAgIGF0dGFja3MucHVzaCh0YXJnZXQpO1xuICAgIC8vIHJldHVybiBpZiBzaGlwIHdhcyBoaXQvd2hpY2ggc2hpcCB3YXMgaGl0P1xuICB9O1xuICBcbiAgY29uc3QgZmxlZXRDb29yZGluYXRlcyA9ICgpID0+e1xuICAgIGNvbnN0IGFyciA9IFtdO1xuICAgIGZvcihsZXQgaT0wO2k8c2hpcHMubGVuZ3RoO2krPTEpe1xuICAgICAgYXJyLnB1c2goc2hpcHNbaV0uY29vcmRpbmF0ZXMpO1xuICAgIH07XG5cbiAgICByZXR1cm4gYXJyO1xuICB9O1xuXG4gIGNvbnN0IGdldFNoaXBzUmVtYWluaW5nID0gKCkgPT4ge1xuICAgIGxldCBzaGlwc1N1bmsgPSAwO1xuXG4gICAgc2hpcHMuZm9yRWFjaCgoc2hpcCk9PntcbiAgICAgIGlmKHNoaXAuaXNTdW5rKCkpe1xuICAgICAgICBzaGlwc1N1bmsgKz0gMTtcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc2hpcHMubGVuZ3RoIC0gc2hpcHNTdW5rO1xuICB9O1xuXG4gIGNvbnN0IGlzRmxlZXRTdW5rID0gKCkgPT4ge1xuICAgIGlmKHNoaXBzLmV2ZXJ5KHNoaXAgPT4gc2hpcC5pc1N1bmsoKSkpe1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICB9O1xuXG4gIHJldHVybiB7IGF0dGFja3MsIHBsYWNlLCByZWNlaXZlQXR0YWNrLCBmbGVldENvb3JkaW5hdGVzLCBnZXRTaGlwc1JlbWFpbmluZywgaXNGbGVldFN1bmsgfTtcbn07IiwiZXhwb3J0IGNvbnN0IGNyZWF0ZVNoaXAgPSAoY29vcmRpbmF0ZUFycmF5KSA9PntcbiAgbGV0IGNvb3JkaW5hdGVzID0gY29vcmRpbmF0ZUFycmF5O1xuICBsZXQgbGVuZ3RoID0gY29vcmRpbmF0ZXMubGVuZ3RoO1xuICBsZXQgZGFtYWdlID0gMDtcblxuICBjb25zdCBoaXQgPSAoKSA9PiB7XG4gICAgZGFtYWdlICs9IDE7XG4gIH07XG5cbiAgY29uc3QgaXNTdW5rID0gKCkgPT4ge1xuICAgIGlmKGxlbmd0aCA9PT0gZGFtYWdlKXtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgfTtcblxuICBjb25zdCBnZXREYW1hZ2UgPSAoKSA9PiB7XG4gICAgcmV0dXJuIGRhbWFnZTtcbiAgfTtcblxuICByZXR1cm4geyBjb29yZGluYXRlcywgaGl0LCBpc1N1bmssIGdldERhbWFnZSB9O1xufTtcbiIsImV4cG9ydCBjb25zdCBoaWdobGlnaHQgPSAoZmlyc3RQbGF5ZXIsIHNlY29uZFBsYXllcikgPT4ge1xuICBjb25zdCBwbGF5ZXJPbmVEaXNwbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXllci1vbmUtZGlzcGxheScpO1xuICBjb25zdCBwbGF5ZXJUd29EaXNwbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXllci10d28tZGlzcGxheScpO1xuXG4gIGlmKGZpcnN0UGxheWVyLmlzVHVybil7XG4gICAgcGxheWVyT25lRGlzcGxheS5jbGFzc0xpc3QuYWRkKCdjdXJyZW50LXBsYXllcicpO1xuICAgIHBsYXllclR3b0Rpc3BsYXkuY2xhc3NMaXN0LnJlbW92ZSgnY3VycmVudC1wbGF5ZXInKTtcbiAgfSBlbHNlIGlmIChzZWNvbmRQbGF5ZXIuaXNUdXJuKXtcbiAgICBwbGF5ZXJUd29EaXNwbGF5LmNsYXNzTGlzdC5hZGQoJ2N1cnJlbnQtcGxheWVyJyk7XG4gICAgcGxheWVyT25lRGlzcGxheS5jbGFzc0xpc3QucmVtb3ZlKCdjdXJyZW50LXBsYXllcicpO1xuICB9O1xufTsiLCJpbXBvcnQgeyBoaWdobGlnaHQgfSBmcm9tIFwiLi4vRE9NL2ludGVyYWN0aW9uL3BsYXllckRpc3BsYXlzXCI7XG5pbXBvcnQgeyByZW5kZXJHcmlkIH0gZnJvbSBcIi4uL0RPTS9pbnRlcmFjdGlvbi9ncmlkXCI7XG5cbmV4cG9ydCBjb25zdCBmaXJzdFR1cm4gPSAoZmlyc3RQbGF5ZXIsIHNlY29uZFBsYXllcikgPT4ge1xuICBsZXQgbnVtYmVyID0gTWF0aC5mbG9vcigoTWF0aC5yYW5kb20oKSAqIDEwKSArIDEpO1xuXG4gIGlmKG51bWJlciUyID09PSAwKXtcbiAgICBmaXJzdFBsYXllci5pc1R1cm4gPSB0cnVlO1xuICAgIGNvbnNvbGUubG9nKGAke2ZpcnN0UGxheWVyLmdldE5hbWUoKX0gR09FUyBGSVJTVC5gKTtcbiAgfSBlbHNlIGlmIChudW1iZXIlMiAhPT0gMCl7XG4gICAgc2Vjb25kUGxheWVyLmlzVHVybiA9IHRydWU7XG4gICAgY29uc29sZS5sb2coYCR7c2Vjb25kUGxheWVyLmdldE5hbWUoKX0gR09FUyBGSVJTVC5gKTtcbiAgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBjaGFuZ2VUdXJuID0gKGZpcnN0UGxheWVyLCBzZWNvbmRQbGF5ZXIpID0+IHtcbiAgaWYoZmlyc3RQbGF5ZXIuaXNUdXJuKXtcbiAgICBmaXJzdFBsYXllci5pc1R1cm4gPSBmYWxzZTtcbiAgICBzZWNvbmRQbGF5ZXIuaXNUdXJuID0gdHJ1ZTtcbiAgICBjb25zb2xlLmxvZyhgSVQgSVMgTk9XICR7c2Vjb25kUGxheWVyLmdldE5hbWUoKX1zIFRVUk4uYCk7XG4gIH0gZWxzZSBpZiAoc2Vjb25kUGxheWVyLmlzVHVybil7XG4gICAgZmlyc3RQbGF5ZXIuaXNUdXJuID0gdHJ1ZTtcbiAgICBzZWNvbmRQbGF5ZXIuaXNUdXJuID0gZmFsc2U7XG4gICAgY29uc29sZS5sb2coYElUIElTIE5PVyAke2ZpcnN0UGxheWVyLmdldE5hbWUoKX1zIFRVUk4uYCk7XG4gIH07XG59O1xuXG5leHBvcnQgY29uc3QgdHVybiA9IGFzeW5jIChmaXJzdFBsYXllciwgc2Vjb25kUGxheWVyLCB0YXJnZXQpID0+IHtcbiAgaWYoZmlyc3RQbGF5ZXIuaXNUdXJuKXtcbiAgICBmaXJzdFBsYXllci5tYWtlQXR0YWNrKHNlY29uZFBsYXllci5ib2FyZCx0YXJnZXQpO1xuICAgIGNoYW5nZVR1cm4oZmlyc3RQbGF5ZXIsc2Vjb25kUGxheWVyKTtcbiAgICBoaWdobGlnaHQoZmlyc3RQbGF5ZXIsc2Vjb25kUGxheWVyKTtcbiAgfSBlbHNlIGlmIChzZWNvbmRQbGF5ZXIuaXNUdXJuKXtcbiAgICBzZWNvbmRQbGF5ZXIubWFrZUF0dGFjayhmaXJzdFBsYXllci5ib2FyZCx0YXJnZXQpO1xuICAgIGNoYW5nZVR1cm4oZmlyc3RQbGF5ZXIsc2Vjb25kUGxheWVyKTtcbiAgICBoaWdobGlnaHQoZmlyc3RQbGF5ZXIsc2Vjb25kUGxheWVyKTtcbiAgfTtcblxuICBpZihmaXJzdFBsYXllci5jb21wdXRlcil7XG4gICAgZmlyc3RQbGF5ZXIubWFrZUF0dGFjayhzZWNvbmRQbGF5ZXIuYm9hcmQpO1xuICAgIGNoYW5nZVR1cm4oZmlyc3RQbGF5ZXIsc2Vjb25kUGxheWVyKTtcbiAgICBoaWdobGlnaHQoZmlyc3RQbGF5ZXIsc2Vjb25kUGxheWVyKTtcbiAgfSBlbHNlIGlmIChzZWNvbmRQbGF5ZXIuY29tcHV0ZXIpe1xuICAgIGNoYW5nZVR1cm4oZmlyc3RQbGF5ZXIsc2Vjb25kUGxheWVyKTtcbiAgICBoaWdobGlnaHQoZmlyc3RQbGF5ZXIsc2Vjb25kUGxheWVyKTtcbiAgfTtcbiAgcmVuZGVyR3JpZChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ3JpZC1jZWxsLTEnKSxmaXJzdFBsYXllcik7XG4gIHJlbmRlckdyaWQoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmdyaWQtY2VsbC0yJyksc2Vjb25kUGxheWVyKTtcbn07XG4iLCJpbXBvcnQgeyBjcmVhdGVQbGF5ZXIgfSBmcm9tIFwiLi4vZmFjdG9yaWVzL2NyZWF0ZVBsYXllclwiO1xuaW1wb3J0IHsgcmVuZGVyR3JpZCB9IGZyb20gXCIuLi9ET00vaW50ZXJhY3Rpb24vZ3JpZFwiO1xuaW1wb3J0IHsgZmlyc3RUdXJuIH0gZnJvbSBcIi4vdHVyblwiO1xuXG5leHBvcnQgbGV0IHBsYXllck9uZSxwbGF5ZXJUd287XG5cbmV4cG9ydCBjb25zdCBzZXR1cCA9IChuYW1lT25lLCBuYW1lVHdvKSA9PiB7XG4gIGxldCB4ID0gdHJ1ZTtcblxuICBpZihuYW1lVHdvID09PSAnY29tcHV0ZXInKXtcbiAgICB4ID0gZmFsc2U7XG4gIH07XG4gIFxuICBwbGF5ZXJPbmUgPSBjcmVhdGVQbGF5ZXIobmFtZU9uZSk7XG4gIHBsYXllclR3byA9IGNyZWF0ZVBsYXllcihuYW1lVHdvLHgpO1xuXG4gIC8vdGVtcG9yYXJ5IHBsYWNlbWVudCBzZXR1cFxuICBwbGF5ZXJPbmUuYm9hcmQucGxhY2UoWydBMicsJ0EzJywnQTQnXSk7XG4gIHBsYXllck9uZS5ib2FyZC5wbGFjZShbJ0UzJywnRjMnLCdHMyddKTtcbiAgcGxheWVyT25lLmJvYXJkLnBsYWNlKFsnQTEnLCdCMScsJ0MxJywnRDEnXSk7XG4gIHBsYXllck9uZS5ib2FyZC5wbGFjZShbJ0MxMCcsJ0QxMCcsJ0UxMCcsJ0YxMCddKTtcblxuICBwbGF5ZXJUd28uYm9hcmQucGxhY2UoWydBNCcsJ0I0JywnQzQnXSk7XG4gIHBsYXllclR3by5ib2FyZC5wbGFjZShbJ0E1JywnQTYnLCdBNyddKTtcbiAgcGxheWVyVHdvLmJvYXJkLnBsYWNlKFsnRTUnLCdGNScsJ0c1JywnSDUnXSk7XG4gIHBsYXllclR3by5ib2FyZC5wbGFjZShbJ0U2JywnRTcnLCdFOCcsJ0U5J10pO1xuXG4gIHJlbmRlckdyaWQoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmdyaWQtY2VsbC0xJykscGxheWVyT25lKTtcbiAgcmVuZGVyR3JpZChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ3JpZC1jZWxsLTInKSxwbGF5ZXJUd28pO1xuXG4gIGZpcnN0VHVybihwbGF5ZXJPbmUscGxheWVyVHdvKTtcbiAgXG4gIGlmKHBsYXllck9uZS5pc1R1cm4mJnBsYXllck9uZS5jb21wdXRlcil7XG4gICAgcGxheWVyT25lLm1ha2VBdHRhY2socGxheWVyVHdvLmJvYXJkKTtcbiAgICBjaGFuZ2VUdXJuKHBsYXllck9uZSxwbGF5ZXJUd28pO1xuICAgIGhpZ2hsaWdodChwbGF5ZXJPbmUscGxheWVyVHdvKTtcbiAgICByZW5kZXJHcmlkKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5ncmlkLWNlbGwtMScpLHBsYXllck9uZSk7XG4gICAgcmVuZGVyR3JpZChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ3JpZC1jZWxsLTInKSxwbGF5ZXJUd28pO1xuICB9IGVsc2UgaWYgKHBsYXllclR3by5pc1R1cm4mJnBsYXllclR3by5jb21wdXRlcil7XG4gICAgcGxheWVyVHdvLm1ha2VBdHRhY2socGxheWVyT25lLmJvYXJkKTtcbiAgICBjaGFuZ2VUdXJuKHBsYXllck9uZSxwbGF5ZXJUd28pO1xuICAgIGhpZ2hsaWdodChwbGF5ZXJPbmUscGxheWVyVHdvKTtcbiAgICByZW5kZXJHcmlkKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5ncmlkLWNlbGwtMScpLHBsYXllck9uZSk7XG4gICAgcmVuZGVyR3JpZChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ3JpZC1jZWxsLTInKSxwbGF5ZXJUd28pO1xuICB9O1xuXG59O1xuXG5leHBvcnQgY29uc3QgZ2FtZVN0YXJ0ID0gYXN5bmMgKCkgPT4ge1xuICBsZXQgcCA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpe1xuICAgIGxldCBzdGFydCA9IHRydWU7XG4gICAgcmVzb2x2ZShzdGFydCk7XG4gIH0pO1xufTtcbiIsImltcG9ydCB7IHBhcnNlQ2VsbENvb3JkaW5hdGUgfSBmcm9tIFwiLi4vLi4vbW9kdWxlcy9wYXJzZUNlbGxDb29yZGluYXRlXCI7XG5pbXBvcnQgeyBwbGF5ZXJPbmUsIHBsYXllclR3byB9IGZyb20gXCIuLi8uLi9tb2R1bGVzL2dhbWVTdGFydFwiO1xuaW1wb3J0IHsgdHVybiB9IGZyb20gXCIuLi8uLi9tb2R1bGVzL3R1cm5cIjtcblxuY29uc3QgZ2V0R3JpZENvb3JkaW5hdGUgPSAoY2VsbCkgPT4ge1xuICBsZXQgY29vcmQgPSBwYXJzZUNlbGxDb29yZGluYXRlKGNlbGwuZ2V0QXR0cmlidXRlKCdkYXRhLWNlbGwtY29vcmRpbmF0ZScpKTtcbiAgcmV0dXJuIGNvb3JkO1xufTtcblxuLy9PTkxZIENMSUNLSU5HIE9OIFRIRSBFTkVNWSBHUklEIFNIT1VMRCBCRSBBQkxFIFRPIEFUVEFDS1xuLy9PTkxZIEhPVkVSSU5HIE9OIFRIRSBFTkVNWSBHUklEIFNIT1VMRCBDSEFOR0UgQ0VMTCBDT0xPUlxuXG5leHBvcnQgY29uc3QgZ3JpZEV2ZW50cyA9ICgpID0+IHtcbiAgY29uc3QgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ3JpZC1jZWxsJyk7XG5cbiAgY2VsbHMuZm9yRWFjaCgobm9kZSk9PntcbiAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSk9PntcbiAgICAgIGxldCBjZWxsID0gZS50YXJnZXQ7XG4gICAgICBsZXQgY29vcmQgPSBnZXRHcmlkQ29vcmRpbmF0ZShjZWxsKTtcbiAgICAgIGNvbnNvbGUubG9nKGBjb29yZGluYXRlOiAke2Nvb3JkfWApO1xuICAgICAgdHVybihwbGF5ZXJPbmUscGxheWVyVHdvLGNvb3JkKTtcbiAgICB9KTtcbiAgfSk7XG59O1xuXG4vL1NIT1VMRE4nVCBSRU5ERVIgUExBWUVSIFRXTyBTSElQUyBJRiBQTEFZSU5HIEFHQUlOU1QgQ09NUFVURVJcbi8vSUYgVFdPIFBMQVlFUiBTSE9VTEROVCBSRU5ERVIgRUlUSEVSIFBMQVlFUlMgU0hJUFNcbmV4cG9ydCBjb25zdCByZW5kZXJHcmlkID0gKGNlbGxzLHBsYXllcikgPT4ge1xuICBjb25zdCBmbGVldCA9IHBsYXllci5ib2FyZC5mbGVldENvb3JkaW5hdGVzKCk7XG4gIGNvbnN0IGFyciA9IGZsZWV0LnJlZHVjZSgoYWNjLHZhbCk9PmFjYy5jb25jYXQodmFsKSk7XG5cbiAgY2VsbHMuZm9yRWFjaCgoY2VsbCk9PntcbiAgICBsZXQgY29vcmQgPSBwYXJzZUNlbGxDb29yZGluYXRlKGNlbGwuZ2V0QXR0cmlidXRlKCdkYXRhLWNlbGwtY29vcmRpbmF0ZScpKTtcbiAgICBpZiAoYXJyLmluY2x1ZGVzKGNvb3JkKSYmcGxheWVyLmJvYXJkLmF0dGFja3MuaW5jbHVkZXMoY29vcmQpKSB7XG4gICAgICBjZWxsLnRleHRDb250ZW50ID0gJ+KXjyc7XG4gICAgfSBlbHNlIGlmICghKGFyci5pbmNsdWRlcyhjb29yZCkpJiZwbGF5ZXIuYm9hcmQuYXR0YWNrcy5pbmNsdWRlcyhjb29yZCkpIHtcbiAgICAgIGNlbGwudGV4dENvbnRlbnQgPSAnLyc7XG4gICAgfSBlbHNlIGlmIChhcnIuaW5jbHVkZXMoY29vcmQpKXtcbiAgICAgIGNlbGwudGV4dENvbnRlbnQgPSAn4peLJztcbiAgICB9O1xuICB9KTtcbn07XG4iLCJjb25zdCBwbGF5ZXJPbmVEaXNwbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXllci1vbmUtZGlzcGxheScpO1xuY29uc3QgcGxheWVyVHdvRGlzcGxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF5ZXItdHdvLWRpc3BsYXknKTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVBsYXllckRpc3BsYXkgPSAocGxheWVyLCBwbGF5ZXJOdW0pID0+IHtcbiAgY29uc3QgZGlzcGxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBkaXNwbGF5LmNsYXNzTGlzdC5hZGQoJ2Rpc3BsYXktY29udCcpO1xuXG4gIGNvbnN0IHBsYXllck51bURpc3BsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMScpO1xuICBwbGF5ZXJOdW1EaXNwbGF5LnRleHRDb250ZW50ID0gYFBMQVlFUiAke3BsYXllck51bX1gO1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcbiAgbmFtZS50ZXh0Q29udGVudCA9IGAke3BsYXllci5nZXROYW1lKCl9YDtcblxuICBjb25zdCB0dXJuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICB0dXJuLnRleHRDb250ZW50ID0gYCR7cGxheWVyLmlzVHVybn1gO1xuICAvL21heWJlIHVzZSBzb21lIG90aGVyIHdheSB0byBkaXNwbGF5IHdob3MgdHVybiBpdCBpcz8/KipcblxuICBjb25zdCBzaGlwcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgc2hpcHMudGV4dENvbnRlbnQgPSBgU2hpcHMgbGVmdDogJHtwbGF5ZXIuYm9hcmQuZ2V0U2hpcHNSZW1haW5pbmcoKX1gO1xuICBjb25zdCB3aW5zID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICB3aW5zLnRleHRDb250ZW50ID0gYFdpbnM6ICR7cGxheWVyLmdldFdpbnMoKX1gO1xuXG4gIGRpc3BsYXkuYXBwZW5kKHBsYXllck51bURpc3BsYXksbmFtZSx0dXJuLHNoaXBzLHdpbnMpO1xuXG4gIGlmKHBsYXllck51bSA9PT0gMSl7XG4gICAgcGxheWVyT25lRGlzcGxheS5hcHBlbmQoZGlzcGxheSk7XG4gIH0gZWxzZSBpZiAocGxheWVyTnVtID09PSAyKXtcbiAgICBwbGF5ZXJUd29EaXNwbGF5LmFwcGVuZChkaXNwbGF5KTtcbiAgfTtcbn07XG5cbi8vcGxheWVyI1xuLy9wbGF5ZXIgbmFtZVxuLy9pcyB0dXJuXG4vL2N1cnJlbnQgc2hpcHMgYWxpdmVcbi8vd2lucyIsImltcG9ydCB7IHNldHVwIH0gZnJvbSAnLi4vLi4vbW9kdWxlcy9nYW1lU3RhcnQnO1xuaW1wb3J0IHsgcGxheWVyT25lLCBwbGF5ZXJUd28gfSBmcm9tICcuLi8uLi9tb2R1bGVzL2dhbWVTdGFydCc7XG5pbXBvcnQgeyBjcmVhdGVQbGF5ZXJEaXNwbGF5IH0gZnJvbSAnLi4vY29tcG9uZW50cy9jcmVhdGVQbGF5ZXJEaXNwbGF5cyc7XG5cbmNvbnN0IG1lbnVNdWx0aXBsYXllciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZW51LW11bHRpcGxheWVyJyk7XG5jb25zdCBtZW51TmFtZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVudS1uYW1lcycpO1xuY29uc3QgbWVudVJ1bGVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lbnUtcnVsZXMnKTtcblxuY29uc3Qgc2luZ2xlUGxheWVyQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NpbmdsZS1wbGF5ZXInKTtcbmNvbnN0IHR3b1BsYXllckJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0d28tcGxheWVyJyk7XG5cbmNvbnN0IHBsYXllck9uZU5hbWVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF5ZXItb25lLW5hbWUnKTtcbi8vIGNvbnN0IHBsYXllclR3b05hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxheWVyLXR3by1uYW1lJyk7XG5jb25zdCBzdGFydEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFydCcpO1xuXG4vLyBsZXQgbXVsdGlwbGF5ZXIgPSBmYWxzZTtcblxuY29uc3QgaGlkZSA9IChtZW51KSA9PiB7XG4gIG1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbn07XG5cbmNvbnN0IHNob3cgPSAobWVudSkgPT4ge1xuIG1lbnUuc3R5bGUuZGlzcGxheSA9IG51bGw7XG59O1xuXG5jb25zdCBnZXROYW1lcyA9ICgpID0+IHtcbiAgbGV0IHBsYXllck9uZSA9IHBsYXllck9uZU5hbWVFbC52YWx1ZTtcbiAgbGV0IHBsYXllclR3byA9ICdjb21wdXRlcic7XG4gIC8vIGlmKCFtdWx0aXBsYXllcil7XG4gIC8vICAgcGxheWVyVHdvID0gJ2NvbXB1dGVyJztcbiAgLy8gfTtcblxuICByZXR1cm4gW3BsYXllck9uZSwgcGxheWVyVHdvXTtcbn07XG5cbi8vbWVudSBpbnRlcmFjdGlvbiBldmVudHNcbmV4cG9ydCBjb25zdCBtZW51RXZlbnRzID0gKCgpID0+IHtcblxuICBzaW5nbGVQbGF5ZXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCgpPT57XG4gICAgaGlkZShtZW51TXVsdGlwbGF5ZXIpO1xuICAgIHNob3cobWVudU5hbWVzKTtcbiAgICBtdWx0aXBsYXllciA9IGZhbHNlO1xuICB9KTtcblxuICB0d29QbGF5ZXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCgpPT57XG4gICAgaGlkZShtZW51TXVsdGlwbGF5ZXIpO1xuICAgIHNob3cobWVudU5hbWVzKTtcbiAgICBtdWx0aXBsYXllciA9IHRydWU7XG4gIH0pO1xuXG4gIHN0YXJ0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoKT0+e1xuICAgIC8vKHNob3VsZCB0cmlnZ2VyIG9uIGhpdHRpbmcgZW50ZXIgYWxzbywgbm90IGp1c3QgY2xpY2suKVxuICAgIC8vY3JlYXRlIHBsYXllcnMgd2l0aCBuYW1lc1xuICAgIGxldCBuYW1lcyA9IGdldE5hbWVzKCk7XG4gICAgbGV0IG5hbWVPbmUgPSBuYW1lc1swXTtcbiAgICBsZXQgbmFtZVR3byA9IG5hbWVzWzFdXG5cbiAgICBpZihuYW1lT25lID09PSAnJyB8fCBuYW1lVHdvID09PSAnJyl7XG4gICAgICByZXR1cm47XG4gICAgfTtcblxuICAgIHNldHVwKG5hbWVPbmUsbmFtZVR3byk7XG4gICAgY3JlYXRlUGxheWVyRGlzcGxheShwbGF5ZXJPbmUsMSk7XG4gICAgY3JlYXRlUGxheWVyRGlzcGxheShwbGF5ZXJUd28sMik7XG5cbiAgICBwbGF5ZXJPbmVOYW1lRWwudmFsdWUgPSAnJztcbiAgICAvLyBwbGF5ZXJUd29OYW1lLnZhbHVlID0gJyc7XG4gICAgaGlkZShtZW51TmFtZXMpO1xuICB9KTtcbn0pKCk7XG4iLCJpbXBvcnQgeyBjcmVhdGVHcmlkIH0gZnJvbSBcIi4uL0RPTS9jb21wb25lbnRzL2NyZWF0ZUdyaWRcIlxuaW1wb3J0IHsgZ3JpZEV2ZW50cyB9IGZyb20gXCIuLi9ET00vaW50ZXJhY3Rpb24vZ3JpZFwiO1xuaW1wb3J0IHsgbWVudUV2ZW50cyB9IGZyb20gXCIuLi9ET00vaW50ZXJhY3Rpb24vbWVudVwiO1xuXG4vL1NFVCBVUCBCQVNFIEdSSURcblxuY29uc3QgcGxheWVyT25lR3JpZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF5ZXItb25lLWdyaWQnKTtcbmNvbnN0IHBsYXllclR3b0dyaWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxheWVyLXR3by1ncmlkJyk7XG5cbmNyZWF0ZUdyaWQocGxheWVyT25lR3JpZCwxKTtcbmNyZWF0ZUdyaWQocGxheWVyVHdvR3JpZCwyKTtcbmdyaWRFdmVudHMoKTtcblxuLy9ET05UIFNUQVJUIExPT1AgVU5USUwgU1RBUlQgQlVUVE9OIElTIENMSUNLRURcblxuLy8gd2hpbGUoIShwbGF5ZXJPbmUuYm9hcmQuaXNGbGVldFN1bmsoKSkmJiEocGxheWVyVHdvLmJvYXJkLmlzRmxlZXRTdW5rKCkpKXtcbi8vICAgdHVybihwbGF5ZXJPbmUscGxheWVyVHdvLHRhcmdldFByb21pc2UpO1xuLy8gICByZW5kZXJHcmlkKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5ncmlkLWNlbGwtMScpLHBsYXllck9uZSk7XG4vLyAgIHJlbmRlckdyaWQoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmdyaWQtY2VsbC0yJykscGxheWVyVHdvKTtcbi8vIH07XG5cblxuLy9kbyBnYW1lIGxvb3AgaWYgZmFjaW5nIGEgY29tcHV0ZXIsIGJ1dCBub3QgaWYgcGxheWluZyAyIHBsYXllcj8/Pz8qKioqXG5cblxuLy9kZWNsYXJlIHdpbm5lclxuXG4vL2RlY2lkZSB3aG8gZ29lcyBmaXJzdCAocGxheWVyIG9uZSBnb2VzIGZpcnN0Pylcbi8vdHVybiBmdW5jdGlvblxuXG4vL0ZJR1VSRSBPVVQgVFVSTlMgTkVYVFxuXG4vL1YgTE9PUCBWXG4vL2FsdGVybmF0ZSB0dXJucyB1bnRpbCB0aGVyZSdzIGEgd2lubmVyXG4vL2FkZCB3aW4gdG8gdGhhdCBwbGF5ZXJcbi8vbG9vc2luZyBwbGF5ZXIgZ2V0cyB0byBnbyBmaXJzdFxuXG4vL2lmIGltcGxlbWVudGVkIHlvdSBzaG91bGQgYmUgYWJsZSB0byByZXN0YXJ0IGEgZ2FtZSBvciBjaGFuZ2UgdGhlIHJ1bGVzIGF0IGFueXRpbWVcbiIsImNvbnNvbGUubG9nKCdjaGVjayBjaGVjaycpXG5pbXBvcnQgJy4vbW9kdWxlcy9nYW1lTG9vcCc7XG4iXSwibmFtZXMiOlsiY3JlYXRlR3JpZCIsImdyaWQiLCJncmlkTnVtIiwiaSIsInJvdyIsImdyaWRSb3ciLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJncmlkQ2VsbCIsInN0eWxlIiwiYm9yZGVyIiwiYXBwZW5kQ2hpbGQiLCJub2RlTGlzdCIsImNoaWxkTm9kZXMiLCJmb3JFYWNoIiwiZSIsInB1c2giLCJmaXJzdENoaWxkIiwiZ2V0QXR0cmlidXRlIiwidGV4dENvbnRlbnQiLCJsYWJlbFJvd3MiLCJTdHJpbmciLCJmcm9tQ2hhckNvZGUiLCJsYWJlbENvbHVtbnMiLCJwYXJzZUNlbGxDb29yZGluYXRlIiwiYXR0cmlidXRlIiwiYXJyIiwic3BsaXQiLCJhcnJheSIsImxldHRlclZhbHVlIiwiaXNOYU4iLCJwYXJzZUludCIsInNsaWNlIiwiam9pbiIsImNvZGVWYWx1ZSIsImdldExldHRlciIsIm51bWJlciIsImxlbmd0aCIsImdldE51bWJlciIsImNyZWF0ZVBsYXllciIsInBsYXllck5hbWUiLCJpc0NvbXAiLCJuYW1lIiwiYm9hcmQiLCJzaGlwcyIsImF0dGFja3MiLCJwbGFjZSIsImNvb3JkaW5hdGVzIiwibmV3U2hpcCIsImNvb3JkaW5hdGVBcnJheSIsImRhbWFnZSIsImhpdCIsImlzU3VuayIsImdldERhbWFnZSIsImNyZWF0ZVNoaXAiLCJyZWNlaXZlQXR0YWNrIiwidGFyZ2V0IiwiaW5jbHVkZXMiLCJzaGlwSW5kZXgiLCJmaW5kSW5kZXgiLCJzaGlwIiwiZmxlZXRDb29yZGluYXRlcyIsImdldFNoaXBzUmVtYWluaW5nIiwic2hpcHNTdW5rIiwiaXNGbGVldFN1bmsiLCJldmVyeSIsImNyZWF0ZUdhbWVib2FyZCIsImNvbXB1dGVyIiwiaXNUdXJuIiwibWFrZUF0dGFjayIsImVuZW15Qm9hcmQiLCJnZW4iLCJnZW5lcmF0ZUNoYXJDb2RlIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwibGV0dGVyIiwiZ2VuZXJhdGVBdHRhY2siLCJjb25zb2xlIiwibG9nIiwiZ2V0TmFtZSIsImdldFdpbnMiLCJmaXJzdFBsYXllciIsInNlY29uZFBsYXllciIsInBsYXllck9uZURpc3BsYXkiLCJnZXRFbGVtZW50QnlJZCIsInBsYXllclR3b0Rpc3BsYXkiLCJyZW1vdmUiLCJwbGF5ZXJPbmUiLCJwbGF5ZXJUd28iLCJyZW5kZXJHcmlkIiwiY2VsbHMiLCJwbGF5ZXIiLCJyZWR1Y2UiLCJhY2MiLCJ2YWwiLCJjb25jYXQiLCJjZWxsIiwiY29vcmQiLCJjcmVhdGVQbGF5ZXJEaXNwbGF5IiwicGxheWVyTnVtIiwiZGlzcGxheSIsInBsYXllck51bURpc3BsYXkiLCJ0dXJuIiwid2lucyIsImFwcGVuZCIsIm1lbnVNdWx0aXBsYXllciIsIm1lbnVOYW1lcyIsInNpbmdsZVBsYXllckJ0biIsInR3b1BsYXllckJ0biIsInBsYXllck9uZU5hbWVFbCIsInN0YXJ0QnRuIiwiaGlkZSIsIm1lbnUiLCJzaG93IiwicGxheWVyT25lR3JpZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJtdWx0aXBsYXllciIsIm5hbWVzIiwidmFsdWUiLCJuYW1lT25lIiwibmFtZVR3byIsIngiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZmlyc3RUdXJuIiwiY2hhbmdlVHVybiIsImhpZ2hsaWdodCIsInNldHVwIiwicGxheWVyVHdvR3JpZCIsIm5vZGUiLCJhc3luYyJdLCJzb3VyY2VSb290IjoiIn0=